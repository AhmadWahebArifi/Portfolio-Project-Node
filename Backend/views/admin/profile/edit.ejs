<div class="row">
  <div class="col-12">
    <div class="admin-card">
      <div class="card-header bg-transparent border-0 py-3">
        <h5 class="mb-0"><i class="fas fa-user-edit"></i> Edit Profile</h5>
      </div>
      <div class="card-body profile-form">
        <form action="/admin/profile/update" method="POST">
          <div class="row">
            <div class="col-lg-3 text-center mb-4 mb-lg-0">
              <div class="profile-avatar mx-auto">
                <div
                  class="avatar-placeholder rounded-circle d-flex align-items-center justify-content-center"
                  style="
                    width: 150px;
                    height: 150px;
                    background-color: var(--admin-light);
                    border: 3px solid var(--border-color);
                    margin: 0 auto;
                  "
                >
                  <i class="fas fa-user fa-4x text-muted"></i>
                </div>
                <div class="mt-3">
                  <button type="button" class="btn btn-sm btn-outline-primary">
                    <i class="fas fa-camera"></i> Change Photo
                  </button>
                  <p class="text-muted small mt-2 mb-0">
                    JPG, PNG, GIF (Max 2MB)
                  </p>
                </div>
              </div>
            </div>
            <div class="col-lg-9">
              <div class="profile-section">
                <h6 class="profile-section-header">Personal Information</h6>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="name" class="form-label">Full Name</label>
                    <input
                      type="text"
                      class="form-control"
                      id="name"
                      name="name"
                      value="<%= user.name %>"
                      required
                      minlength="2"
                      maxlength="50"
                    />
                    <div class="invalid-feedback">
                      Please enter a valid name (2-50 characters)
                    </div>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="email" class="form-label">Email Address</label>
                    <input
                      type="email"
                      class="form-control"
                      id="email"
                      name="email"
                      value="<%= user.email %>"
                      required
                    />
                    <div class="invalid-feedback">
                      Please enter a valid email address
                    </div>
                  </div>
                </div>
              </div>

              <div class="profile-section">
                <h6 class="profile-section-header">Account Information</h6>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Role</label>
                    <input
                      type="text"
                      class="form-control"
                      value="<%= user.role.charAt(0).toUpperCase() + user.role.slice(1) %>"
                      readonly
                    />
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Account Status</label>
                    <input
                      type="text"
                      class="form-control"
                      value="<%= user.isActive ? 'Active' : 'Inactive' %>"
                      readonly
                    />
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Member Since</label>
                    <input
                      type="text"
                      class="form-control"
                      value="<%= moment(user.createdAt).format('MMMM Do, YYYY') %>"
                      readonly
                    />
                  </div>
                </div>
              </div>

              <div class="d-flex gap-2 mt-4">
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-save"></i> Save Changes
                </button>
                <a href="/admin/profile" class="btn btn-secondary">
                  <i class="fas fa-times"></i> Cancel
                </a>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
  // Basic form validation
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.querySelector("form");
    const nameInput = document.getElementById("name");
    const emailInput = document.getElementById("email");

    form.addEventListener("submit", function (e) {
      let isValid = true;

      // Validate name
      if (
        nameInput.value.trim().length < 2 ||
        nameInput.value.trim().length > 50
      ) {
        nameInput.classList.add("is-invalid");
        isValid = false;
      } else {
        nameInput.classList.remove("is-invalid");
      }

      // Validate email
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(emailInput.value)) {
        emailInput.classList.add("is-invalid");
        isValid = false;
      } else {
        emailInput.classList.remove("is-invalid");
      }

      if (!isValid) {
        e.preventDefault();
      }
    });

    // Real-time validation
    nameInput.addEventListener("input", function () {
      if (this.value.trim().length >= 2 && this.value.trim().length <= 50) {
        this.classList.remove("is-invalid");
      }
    });

    emailInput.addEventListener("input", function () {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (emailRegex.test(this.value)) {
        this.classList.remove("is-invalid");
      }
    });
  });
</script>
