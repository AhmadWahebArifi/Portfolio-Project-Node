<div class="row justify-content-center">
  <div class="col-lg-8">
    <div class="admin-card">
      <div class="card-header bg-transparent border-0 py-3">
        <h5 class="mb-0"><i class="fas fa-key"></i> Change Password</h5>
      </div>
      <div class="card-body profile-form">
        <form
          action="/admin/profile/change-password"
          method="POST"
          id="changePasswordForm"
        >
          <div class="mb-3">
            <label for="currentPassword" class="form-label"
              >Current Password</label
            >
            <div class="input-group">
              <span class="input-group-text">
                <i class="fas fa-lock"></i>
              </span>
              <input
                type="password"
                class="form-control"
                id="currentPassword"
                name="currentPassword"
                required
                minlength="6"
              />
            </div>
          </div>

          <div class="mb-3">
            <label for="newPassword" class="form-label">New Password</label>
            <div class="input-group">
              <span class="input-group-text">
                <i class="fas fa-key"></i>
              </span>
              <input
                type="password"
                class="form-control"
                id="newPassword"
                name="newPassword"
                required
                minlength="6"
              />
            </div>
            <div class="password-requirements mt-2">
              <p class="mb-1">Password requirements:</p>
              <ul class="mb-0">
                <li id="length-req" class="invalid">
                  <i class="fas fa-times-circle"></i> At least 6 characters
                </li>
                <li id="match-req" class="invalid">
                  <i class="fas fa-times-circle"></i> Passwords must match
                </li>
              </ul>
            </div>
          </div>

          <div class="mb-4">
            <label for="confirmPassword" class="form-label"
              >Confirm New Password</label
            >
            <div class="input-group">
              <span class="input-group-text">
                <i class="fas fa-key"></i>
              </span>
              <input
                type="password"
                class="form-control"
                id="confirmPassword"
                name="confirmPassword"
                required
                minlength="6"
              />
            </div>
          </div>

          <div class="d-flex gap-2">
            <button type="submit" class="btn btn-primary" id="submitBtn">
              <i class="fas fa-save"></i> Change Password
            </button>
            <a href="/admin/profile" class="btn btn-secondary">
              <i class="fas fa-times"></i> Cancel
            </a>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const newPassword = document.getElementById("newPassword");
    const confirmPassword = document.getElementById("confirmPassword");
    const submitBtn = document.getElementById("submitBtn");
    const form = document.getElementById("changePasswordForm");

    // Password validation
    function validatePassword() {
      const lengthReq = document.getElementById("length-req");
      const matchReq = document.getElementById("match-req");

      // Check length
      if (newPassword.value.length >= 6) {
        lengthReq.classList.remove("invalid");
        lengthReq.classList.add("valid");
        lengthReq.innerHTML =
          '<i class="fas fa-check-circle"></i> At least 6 characters';
      } else {
        lengthReq.classList.remove("valid");
        lengthReq.classList.add("invalid");
        lengthReq.innerHTML =
          '<i class="fas fa-times-circle"></i> At least 6 characters';
      }

      // Check match
      if (
        newPassword.value === confirmPassword.value &&
        confirmPassword.value.length > 0
      ) {
        matchReq.classList.remove("invalid");
        matchReq.classList.add("valid");
        matchReq.innerHTML =
          '<i class="fas fa-check-circle"></i> Passwords must match';
      } else if (confirmPassword.value.length > 0) {
        matchReq.classList.remove("valid");
        matchReq.classList.add("invalid");
        matchReq.innerHTML =
          '<i class="fas fa-times-circle"></i> Passwords must match';
      } else {
        matchReq.classList.remove("valid");
        matchReq.classList.add("invalid");
        matchReq.innerHTML =
          '<i class="fas fa-times-circle"></i> Passwords must match';
      }
    }

    // Add event listeners
    newPassword.addEventListener("input", validatePassword);
    confirmPassword.addEventListener("input", validatePassword);

    // Form submission
    form.addEventListener("submit", function (e) {
      if (
        newPassword.value.length < 6 ||
        newPassword.value !== confirmPassword.value
      ) {
        e.preventDefault();
        alert("Please ensure your password meets all requirements.");
      }
    });
  });
</script>
