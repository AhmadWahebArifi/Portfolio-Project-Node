<div class="d-flex justify-content-between align-items-center mb-4">
  <h2><i class="fas fa-folder"></i> <%= project.id ? 'Edit' : 'Add New' %> Project</h2>
  <a href="/admin/projects" class="btn btn-outline-secondary">
    <i class="fas fa-arrow-left"></i> Back to Projects
  </a>
</div>

<div class="admin-card">
  <div class="card-body">
    <form action="<%= action %>" method="POST">
      <% if (method === 'PUT') { %>
      <input type="hidden" name="_method" value="PUT">
      <% } %>

      <div class="row">
        <div class="col-md-8">
          <div class="mb-3">
            <label for="title" class="form-label">Project Title *</label>
            <input
              type="text"
              class="form-control <%= typeof messages !== 'undefined' && messages.error && messages.error.includes('Title') ? 'is-invalid' : '' %>"
              id="title"
              name="title"
              value="<%= project.title || '' %>"
              required
            />
            <% if (typeof messages !== 'undefined' && messages.error && messages.error.includes('Title')) { %>
              <div class="invalid-feedback">
                <%= messages.error %>
              </div>
            <% } %>
          </div>

          <div class="mb-3">
            <label for="description" class="form-label">Short Description *</label>
            <textarea
              class="form-control <%= typeof messages !== 'undefined' && messages.error && messages.error.includes('Description') ? 'is-invalid' : '' %>"
              id="description"
              name="description"
              rows="3"
              required
            ><%= project.description || '' %></textarea>
            <% if (typeof messages !== 'undefined' && messages.error && messages.error.includes('Description')) { %>
              <div class="invalid-feedback">
                <%= messages.error %>
              </div>
            <% } %>
          </div>

          <div class="mb-3">
            <label for="longDescription" class="form-label">Long Description</label>
            <textarea
              class="form-control"
              id="longDescription"
              name="longDescription"
              rows="5"
            ><%= project.longDescription || '' %></textarea>
          </div>
        </div>

        <div class="col-md-4">
          <div class="mb-3">
            <label for="category" class="form-label">Category *</label>
            <select class="form-select <%= typeof messages !== 'undefined' && messages.error && messages.error.includes('category') ? 'is-invalid' : '' %>" id="category" name="category" required>
              <option value="">Select Category</option>
              <option value="web" <%= project.category === 'web' ? 'selected' : '' %>>Web</option>
              <option value="mobile" <%= project.category === 'mobile' ? 'selected' : '' %>>Mobile</option>
              <option value="desktop" <%= project.category === 'desktop' ? 'selected' : '' %>>Desktop</option>
              <option value="api" <%= project.category === 'api' ? 'selected' : '' %>>API</option>
              <option value="other" <%= project.category === 'other' ? 'selected' : '' %>>Other</option>
            </select>
            <% if (typeof messages !== 'undefined' && messages.error && messages.error.includes('category')) { %>
              <div class="invalid-feedback">
                <%= messages.error %>
              </div>
            <% } %>
          </div>

          <div class="mb-3">
            <label for="status" class="form-label">Status</label>
            <select class="form-select" id="status" name="status">
              <option value="planning" <%= project.status === 'planning' ? 'selected' : '' %>>Planning</option>
              <option value="in-progress" <%= project.status === 'in-progress' ? 'selected' : '' %>>In Progress</option>
              <option value="completed" <%= project.status === 'completed' ? 'selected' : '' %>>Completed</option>
              <option value="on-hold" <%= project.status === 'on-hold' ? 'selected' : '' %>>On Hold</option>
            </select>
          </div>

          <div class="mb-3">
            <label for="order" class="form-label">Display Order</label>
            <input
              type="number"
              class="form-control"
              id="order"
              name="order"
              value="<%= project.order || 0 %>"
            />
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-md-6">
          <div class="mb-3">
            <label for="technologies" class="form-label">Technologies *</label>
            <input
              type="text"
              class="form-control <%= typeof messages !== 'undefined' && messages.error && (messages.error.includes('technology') || messages.error.includes('Technologies')) ? 'is-invalid' : '' %>"
              id="technologies"
              name="technologies"
              value="<%= Array.isArray(project.technologies) ? project.technologies.join(', ') : project.technologies || '' %>"
              placeholder="React, Node.js, MongoDB"
              required
            />
            <div class="form-text">Separate technologies with commas</div>
            <% if (typeof messages !== 'undefined' && messages.error && (messages.error.includes('technology') || messages.error.includes('Technologies'))) { %>
              <div class="invalid-feedback">
                <%= messages.error %>
              </div>
            <% } %>
          </div>
        </div>

        <div class="col-md-6">
          <div class="row">
            <div class="col-6">
              <div class="mb-3">
                <label for="liveUrl" class="form-label">Live URL</label>
                <input
                  type="url"
                  class="form-control <%= typeof messages !== 'undefined' && messages.error && messages.error.includes('URL') ? 'is-invalid' : '' %>"
                  id="liveUrl"
                  name="liveUrl"
                  value="<%= project.liveUrl || '' %>"
                />
                <% if (typeof messages !== 'undefined' && messages.error && messages.error.includes('URL')) { %>
                  <div class="invalid-feedback">
                    <%= messages.error %>
                  </div>
                <% } %>
              </div>
            </div>
            <div class="col-6">
              <div class="mb-3">
                <label for="githubUrl" class="form-label">GitHub URL</label>
                <input
                  type="url"
                  class="form-control <%= typeof messages !== 'undefined' && messages.error && messages.error.includes('URL') ? 'is-invalid' : '' %>"
                  id="githubUrl"
                  name="githubUrl"
                  value="<%= project.githubUrl || '' %>"
                />
                <% if (typeof messages !== 'undefined' && messages.error && messages.error.includes('URL')) { %>
                  <div class="invalid-feedback">
                    <%= messages.error %>
                  </div>
                <% } %>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row mb-4">
        <div class="col-md-3">
          <div class="form-check">
            <input
              class="form-check-input"
              type="checkbox"
              id="featured"
              name="featured"
              value="true"
              <%= project.featured ? 'checked' : '' %>
            />
            <label class="form-check-label" for="featured">
              <i class="fas fa-star text-warning"></i> Featured Project
            </label>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-check">
            <input
              class="form-check-input"
              type="checkbox"
              id="isPublic"
              name="isPublic"
              value="true"
              <%= project.isPublic !== false ? 'checked' : '' %>
            />
            <label class="form-check-label" for="isPublic">
              <i class="fas fa-eye text-success"></i> Public Project
            </label>
          </div>
        </div>
      </div>

      <div class="d-flex justify-content-end gap-2">
        <a href="/admin/projects" class="btn btn-outline-secondary">Cancel</a>
        <% if (project.id) { %>
        <a href="/admin/projects/<%= project.id %>" class="btn btn-outline-info">
          <i class="fas fa-eye"></i> View Details
        </a>
        <% } %>
        <button type="submit" class="btn btn-admin-primary">
          <i class="fas fa-save"></i> <%= project.id ? 'Update' : 'Create' %> Project
        </button>
      </div>
    </form>
  </div>
</div>